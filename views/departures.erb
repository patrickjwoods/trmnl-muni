<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SF Muni Departures â€” TRMNL Preview</title>
  <link rel="stylesheet" href="https://usetrmnl.com/css/latest/plugins.css">
  <style>
    body { background: #e5e5e5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
    .screen { width: 800px; height: 480px; background: #fff; overflow: hidden; box-shadow: 0 2px 20px rgba(0,0,0,0.15); }
  </style>
</head>
<body>
  <div class="screen">
    <div class="view view--full">
      <div class="layout layout--col">
        <div class="columns">
          <div class="column">
            <div class="title_bar">
              <span class="title">SF Muni</span>
              <span class="instance"><%= @updated_at %></span>
            </div>
            <% @stops.each do |stop| %>
              <div class="meta" style="margin-top: 8px;"><%= stop[:stop_name] %></div>
              <table class="table table--gap-s">
                <thead>
                  <tr>
                    <th>Line</th>
                    <th>Destination</th>
                    <th>Next Departures</th>
                  </tr>
                </thead>
                <tbody>
                  <% stop[:lines].each do |line| %>
                  <tr>
                    <td class="bold"><%= line[:line] %></td>
                    <td><%= line[:destination] %></td>
                    <td>
                      <% if line[:departures].any? %>
                        <%= line[:departures].map { |d| d[:time] }.join(", ") %>
                      <% else %>
                        --
                      <% end %>
                    </td>
                  </tr>
                  <% end %>
                </tbody>
              </table>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
